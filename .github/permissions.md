Below is a summary of what the application does in a categorized way.
A simpler non-technical explanation of what our program does can be found [here](summary.md)
 
- `IO`
    - Connects to named pipe (`discord-ipc-{0}`)
        - Handled by Nuget package [DiscordRichPresence](https://www.nuget.org/packages/DiscordRichPresence)
    - `Write Access`
        - Writes a single Log File to the `MuMu RichPresence.exe` directory
            - `MuMu RichPresence.log`
        - Writes a single JSON File to the `MuMu_RichPresence.exe` directory
            - `detectable.json`
            - This is a reduced cached collection of `https://discord.com/api/v9/games/detectable`
        - _Can_ create a single registry key (`\HKCU\Software\Microsoft\Windows\CurrentVersion\Run\MuMu RichPresence`)
            - For running on startup
            - Default is off, configurable by the user
    - `Read Access`
        - Reads Start Menu shortcuts for `MuMu Player*` / `MuMuPlayer*`
        - Walks the directory of the file found previously (`MuMu Player*` / `MuMuPlayer*`)
            - `../vms/???/logs/shell.log`
        - Reads the file (`logs/shell.log`) if it exists
            - See [Technical-Document](technical-1.md)
        - Reads directory changes for a single directory (`Logs/`)
            - The "File System Watcher" watches for changes on `shell.log` only
        - Reads a single registry key (`\HKCU\Software\Microsoft\Windows\CurrentVersion\Run\MuMu RichPresence`)
            - Run on Startup
        - Reads the first `.env` file it finds in either the current `.exe` directory or in its parent's (recursively)
        - Walks to the root directory from `MuMuNxDevice.exe` (MuMuPlayerGlobal-12.0)
          - Searches for any files in the root directory and subdirectories for `adb.exe` 
          - Searches for the `vms` directory in the root directory, then searches in subdirectories for `vm_config.json`
- `Network`
    - `Download Access`
        - _Can_ download updates from `https://github.com/JustArion/MuMu_RichPresence`
            - Handled by Nuget package [Velopack](https://www.nuget.org/packages/Velopack)
        - Downloads info from `https://discord.com/api/v9/games/detectable`
            - This is used to get the application ids of registered games on Discord
            - JSON data
        - Accesses the site `https://play.google.com/store/apps/details?id=`
            - The id would be the package name of the app used
            - This is used to get the icon for the game you're currently playing  on MuMu
            - HTML data
        - Accesses the site `https://article.biliimg.com/bfs/game/`
          - Rich Presence icon url after `/game/`
          - This is a CDN for the BiliGame store page
          - Image data
        - Accesses the site `https://line3-h5-mobile-api.biligame.com/game/center/h5/search/game_name?keyword={gameName}&sdk_type=2`
          - This is used to get the ID for the BiliGame store page
          - This is used to get the link fot the Rich Presence icon
          - JSON data
    - `Upload Access`
        - Sends telemetry (`http://localhost:9999`)
            - Configurable by the user / command line, Handled by Nuget package [Serilog.Sinks.Seq](https://www.nuget.org/packages/Serilog.Sinks.Seq) & external application ([Seq](https://datalust.co/seq))
- `Process`
    - `Read Access`
        - Looks for the file path of processes [`MuMuPlayer.exe`, `MuMuNxMain.exe`]
        - Checks how many processes of [`MuMuPlayer.exe`, `MuMuNxMain.exe`] are running
            - Clears Rich Presence when process ends
    - `Inter-Process Communication`
      - _Can_ connect to Android Debug Bridge (`adb.exe`)
        - Used to query running apps and activity info from MuMu Emulator
        - The Local IP is found in `../MuMuPlayerGlobal-12.0/configs/vm_config.json`